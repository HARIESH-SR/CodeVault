<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Solution Editor</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=1">
        <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
        <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
        <script src="https://cjrtnc.leaningtech.com/loader.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

        <script src="render-ping.js"></script>
        <script src="autologout.js"></script>
        <script src="snippets.js"></script>
        <script>
          window.addEventListener('DOMContentLoaded', () => {
            const allowedDomain = "https://mycodess.netlify.app";
            const currentDomain = window.location.origin;
        
            if (currentDomain !== allowedDomain) {
              document.body.innerHTML = `
                <div style="padding: 2rem; font-family: sans-serif; text-align: center;">
                  <h1>üîí Access Denied</h1>
                  <p>This page is not accessible from <strong>${currentDomain}</strong>.</p>
                </div>
              `;
              console.warn("Blocked unauthorized domain:", currentDomain);
              return;
            }
          });
      </script>
        <link rel="stylesheet" href="solution.css">
    </head>
    <body>
        <div id="top-bar">
            <div id="problemTitle">Solution Title</div>
            <div id="controls">
                <select id="lang">
                    <option value="python">Python 3.8</option>
                    <option value="cpp">C++ 9</option>
                    <option value="java">Java 13</option>
                    <option value="javascript">JavaScript</option>
                    <option value="c">C</option>
                    <option value="php">PHP</option>
                    <option value="ruby">Ruby</option>
                    <option value="rust">Rust</option>
                    <option value="swift">Swift</option>
                    <option value="kotlin">Kotlin</option>
                    <option value="go">Golang</option>
                    <option value="typescript">TypeScript</option>
                </select>
                <button onclick="runCode()" id="run-btn" title="Run (Ctrl + Enter)">‚ñ∂</button>
                <div id="serverStatus" style="
                    margin-left: 0px;
                    padding: 4px;
                    background-color: #999;
                    color: white;
                    font-size: 16px;
                    border-radius: 50%;
                    width: 15px;
                    height: 15px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-family: 'Segoe UI', sans-serif;
                    cursor: default;
                    " title="Checking server...">
                    ‚è≥
                </div>
                <button id="openGeminiBtn" type="button" style="background:#2d3c68;color:#ffe082;border-radius:4px;margin-left:10px;font-weight:bold;" onclick="openGeminiChat()">Ask Gemini</button>

                <button onclick="saveSolution()" title="Save (Ctrl + S)">üíæ</button>
                <button class="font-btn" onclick="changeFontSize('editor', -1)" title="Decrease editor font size">A‚àí</button>
                <button class="font-btn" onclick="changeFontSize('editor', 1)" title="Increase editor font size">A+</button>
                <button class="copy-btn" onclick="copyTextFromEditor()" title="Copy editor">Copy</button>
                <button class="font-btn" onclick="toggleWordWrap()" title="word wrap">‚Ü©Ô∏è</button>
                <button class="font-btn" onclick="toggleFullScreenEditor()" title="Fullscreen editor">‚õ∂</button>
                <button onclick="maximizeEditor()" title="Maximize Editor">üñµ Editor</button>
                <button onclick="maximizeIO()" title="Maximize Input/Output">üñµ IO</button>
                <button onclick="resetLayout()" title="Reset Layout">üóó Reset</button>
                <label class="toggle-container" title="Maximize Editor on Focus">
                <input type="checkbox" id="autoMaxToggle" />
                <span class="custom-toggle"></span>
                </label>
                <select onchange="redirectToExtractor(this)">
                    <option selected disabled>üì• Extract From...</option>
                    <option value="leetcode">LeetCode</option>
                    <option value="gfg">GeeksForGeeks</option>
                </select>
                <button id="problemDataBtn" style="display: none;">üìò Problem Data</button>
                <button onclick="handleClose()" title="Close">‚ùå</button>
            </div>
        </div>
        <div id="editor" class="full-width"></div>
        <!-- Gemini AI Assistant -->
        <div id="resizer"></div>
        <div id="io-section">
            <div id="inputContainer">
                <textarea id="inputArea" placeholder="Type Input here..."></textarea>
                <div class="font-controls">
                    <button class="font-btn" onclick="changeFontSize('input', -1)" title="Decrease size">A‚àí</button>
                    <button class="font-btn" onclick="changeFontSize('input', 1)" title="Increase size">A+</button>
                    <button class="copy-btn" onclick="copyText('inputArea')" title="copy">üìã</button>
                </div>
            </div>
            <div id="outputContainer">
                <div id="output">Output will appear here...</div>
                <div class="font-controls">
                    <button class="font-btn" onclick="changeFontSize('output', -1)" title="Decrease size">A‚àí</button>
                    <button class="font-btn" onclick="changeFontSize('output', 1)" title="Increase size">A+</button>
                    <button class="copy-btn" onclick="copyText('output')" title="copy">üìã</button>
                </div>
            </div>
        </div>
        <!-- Gemini Chat Overlay and Side Panel -->
<div id="chat-overlay" onclick="closeGeminiChat()" style="display:none;"></div>

<div id="gemini-chat-panel" tabindex="-1" aria-label="Gemini Chat" style="display:none;">
  <div class="gemini-chat-header" style="padding: 9px 14px 4px 13px; font-weight: 600; color: #ffe082; font-size: 18px; display: flex; align-items: center; justify-content: space-between;">
    <span>ü§ñ Gemini AI Assistant</span>
    <button id="close-gemini-btn" onclick="closeGeminiChat()" aria-label="Close" style="border:none;background:none;color:#aaa;font-size:24px;font-weight:bold;cursor:pointer;">√ó</button>
  </div>
  <div class="gemini-chat-body" id="geminiChatHistory" style="flex:1 1 auto;overflow-y:auto;padding:10px 17px 4px 16px;background:#20223b;display:flex;flex-direction:column;"></div>
    <!-- Chat options checkboxes START -->
  <div class="chat-options" style="margin: 0 0 7px 0; display: flex; gap: 12px; align-items: center;">
    <label><input type="checkbox" id="includeCodeBox" checked> Code</label>
    <label><input type="checkbox" id="includeInputBox"> Input</label>
    <label><input type="checkbox" id="includeOutputBox"> Output</label>
  </div>
  <!-- Chat options checkboxes END -->
  <form class="gemini-chat-input" onsubmit="chatAskGemini(event)" style="display:flex;gap:7px;padding:9px 15px 19px 15px;background:#222644;border-top:1px solid #353b4d;">
    <textarea id="chatPromptInput" autocomplete="off" placeholder="Type a prompt..." rows="1"
    style="font-size:15px;flex:1 1 0; border-radius:5px; border:1px solid #31364d; background:#23263a; color:#fff;
    padding:7px 10px; resize:none; overflow-y:auto; min-height:38px; max-height:110px;"></textarea>
    <button id="chatAskGeminiBtn" type="submit" aria-label="Send" style="display:flex;align-items:center;justify-content:center;width:44px;height:40px;">
  <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
    <path d="M11 17V5M11 5L5 11M11 5L17 11" stroke="#FFF" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
  </svg>
</button>
  
</form>

</div>

        <script>
            function maximizeEditor() {
              const editorEl = document.getElementById("editor");
              const ioSection = document.getElementById("io-section");
              const resizer = document.getElementById("resizer");
            
              editorEl.classList.add("maximize-editor");
              editorEl.classList.remove("hidden");
              ioSection.classList.add("hidden");
              resizer.classList.add("hidden");
            
              // Give browser a tiny delay to apply CSS changes, then resize Monaco
              setTimeout(() => {
                if (window.editor) {
                  window.editor.layout();
                }
              }, 50);
            }
            
            function maximizeIO() {
              const editor = document.getElementById("editor");
              const ioSection = document.getElementById("io-section");
              const resizer = document.getElementById("resizer");
            
              editor.classList.add("hidden");
              editor.classList.remove("maximize-editor");
            
              ioSection.classList.remove("hidden");
              ioSection.classList.add("maximize-io");
            
              resizer.classList.add("hidden");
            }

            function resetLayout() {
              const editor = document.getElementById("editor");
              const ioSection = document.getElementById("io-section");
              const resizer = document.getElementById("resizer");
            
              editor.classList.remove("maximize-editor", "hidden");
              ioSection.classList.remove("maximize-io", "hidden");
              resizer.classList.remove("hidden");

              setTimeout(() => {
                if (window.editor) {
                  window.editor.layout();
                }
              }, 50);
            }
            
            
            
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/loader.min.js"></script>
        <script src="solution.js"></script>
    </body>
</html>
